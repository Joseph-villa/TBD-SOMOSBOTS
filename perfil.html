<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - Trueque Digital</title>
    <!-- Asumo que usas Font Awesome para los iconos y una librer√≠a de estilos (ej. Tailwind CSS) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos b√°sicos para las tarjetas de publicaci√≥n */
        .pub-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            position: relative;
            transition: transform 0.2s;
        }
        .pub-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }
        .pub-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        .pub-credit {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #22c55e; /* Green 500 */
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.875rem;
        }
        .pub-content {
            padding: 15px;
        }
        /* Estilos del men√∫ de opciones */
        .menu-dots {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            cursor: pointer;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .menu-opciones {
            position: absolute;
            top: 40px;
            left: 10px;
            background-color: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            list-style: none;
            padding: 0;
            margin: 0;
            z-index: 20;
            min-width: 120px;
            display: none; /* Oculto por defecto */
        }
        .menu-opciones.show {
            display: block;
        }
        .menu-opciones li {
            padding: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            color: #4b5563;
        }
        .menu-opciones li:hover {
            background-color: #f3f4f6;
        }
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #6b7280;
        }
        .no-posts {
            grid-column: 1 / -1; /* Ocupar todo el ancho */
            text-align: center;
            padding: 50px;
            background-color: #f9fafb;
            border-radius: 12px;
            border: 1px dashed #e5e7eb;
        }
        /* Estilos del Modal */
        #modalEmprendedor {
            display: none; /* Empezar oculto y se muestra con JS */
            align-items: center;
            justify-content: center;
        }
        .modal-visible {
            display: flex !important;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="flex justify-between items-center mb-6">
            <button id="backBtn" class="text-green-600 hover:text-green-800 transition duration-150">
                <i class="fas fa-arrow-left mr-2"></i> Volver al Dashboard
            </button>
            <h1 class="text-3xl font-extrabold text-gray-800">Mi Perfil</h1>
            <button id="logoutBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition duration-150">
                <i class="fas fa-sign-out-alt"></i> Salir
            </button>
        </header>

        <!-- Secci√≥n de Datos del Usuario -->
        <section class="bg-white rounded-xl shadow-lg p-6 mb-8 border-t-4 border-green-500">
            <div class="flex items-center space-x-6">
                <div class="flex-shrink-0">
                    <div class="w-16 h-16 bg-green-200 rounded-full flex items-center justify-center text-green-700 text-3xl font-bold">
                        <i class="fas fa-user-circle"></i>
                    </div>
                </div>
                <div>
                    <h2 id="profileName" class="text-2xl font-bold text-gray-900">Cargando Nombre...</h2>
                    <p id="profileEmail" class="text-gray-500 text-sm">Cargando Correo...</p>
                    <div class="mt-2 flex items-center space-x-4">
                        <span class="px-3 py-1 bg-yellow-100 text-yellow-800 font-semibold text-sm rounded-full">
                            Saldo: <span id="saldoBadge">0 ‚ôªÔ∏è</span>
                        </span>
                        <button id="recargarBtn" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            Recargar Cr√©ditos
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Bot√≥n de Solicitud de Emprendedor -->
            <div class="mt-6 pt-4 border-t border-gray-100">
                <div id="emprendedorSection" class="p-4 bg-green-50 rounded-lg border border-green-200">
                    <h3 class="text-lg font-semibold text-green-800 mb-2 flex items-center">
                        <i class="fas fa-store mr-2"></i> Estado de Emprendedor
                    </h3>
                    <p id="emprendedorStatus" class="text-gray-700 mb-4">
                        Puedes postularte para obtener el rol de "Emprendedor" y empezar a monetizar.
                    </p>
                    <button 
                        id="btnSolicitarEmprendedor"
                        class="px-4 py-2 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition duration-200 shadow-md text-sm">
                        <i class="fas fa-handshake mr-1"></i> Solicitar Rol
                    </button>
                </div>
            </div>
        </section>

        <!-- Secci√≥n de Estad√≠sticas -->
        <section class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white rounded-xl shadow p-4 text-center">
                <p class="text-3xl font-extrabold text-green-600" id="pubCount">0</p>
                <p class="text-gray-500 text-sm">Publicaciones Activas</p>
            </div>
            <div class="bg-white rounded-xl shadow p-4 text-center">
                <p class="text-3xl font-extrabold text-green-600" id="vendidosCount">0</p>
                <p class="text-gray-500 text-sm">Cr√©ditos Generados</p>
            </div>
            <!-- Otros contadores si los tienes -->
        </section>

        <!-- Mis Publicaciones -->
        <section class="mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800">Mis Publicaciones</h2>
                <button id="openFormBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-150">
                    <i class="fas fa-plus"></i> Crear Nueva
                </button>
            </div>
            <div id="userPostsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Las publicaciones se renderizar√°n aqu√≠ -->
            </div>
        </section>
    </div>

    <!-- ------------------------------------------------------------------ -->
    <!-- MODAL PARA SOLICITUD DE EMPRENDEDOR (Colocado al final del body) -->
    <!-- ------------------------------------------------------------------ -->
    <div id="modalEmprendedor" class="fixed inset-0 bg-gray-900 bg-opacity-70 items-center justify-center z-50 transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-6 m-4 transform transition-transform duration-300 scale-95 opacity-0" id="modalContent">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 flex items-center">
                <i class="fas fa-rocket mr-2 text-green-600"></i> Postulaci√≥n Emprendedor
            </h2>
            
            <form id="formSolicitudEmprendedor">
                <!-- Campos del formulario -->
                <div class="mb-4">
                    <label for="nombreNegocio" class="block text-sm font-medium text-gray-700">Nombre del Negocio / Marca <span class="text-red-500">*</span></label>
                    <input type="text" id="nombreNegocio" required
                           class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500">
                </div>

                <div class="mb-4">
                    <label for="descripcionNegocio" class="block text-sm font-medium text-gray-700">Describe tu modelo sostenible y por qu√© usas el trueque <span class="text-red-500">*</span></label>
                    <textarea id="descripcionNegocio" rows="3" required
                              class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500"></textarea>
                </div>

                <div class="mb-4">
                    <label for="productosServicios" class="block text-sm font-medium text-gray-700">Productos o Servicios Principales a Ofrecer <span class="text-red-500">*</span></label>
                    <textarea id="productosServicios" rows="2" required
                              class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500"></textarea>
                </div>

                <div class="mb-6">
                    <label for="urlContacto" class="block text-sm font-medium text-gray-700">Sitio Web / Red Social (Opcional)</label>
                    <input type="url" id="urlContacto" 
                           class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500">
                </div>

                <!-- Botones -->
                <div class="flex justify-end space-x-3">
                    <button type="button" id="btnCerrarModal"
                            class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition duration-150">
                        Cancelar
                    </button>
                    <button type="submit"
                            class="px-4 py-2 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 transition duration-150">
                        Enviar Postulaci√≥n
                    </button>
                </div>
            </form>
        </div>
    </div>


    <!-- ------------------------------------------------------------------ -->
    <!-- L√ìGICA JAVASCRIPT DEL PERFIL (Tu c√≥digo original + funciones nuevas) -->
    <!-- ------------------------------------------------------------------ -->
    
    <script type="module">
        import { supabase } from './config/db.js';

        // --- Elementos del DOM ---
        const backBtn = document.getElementById('backBtn');
        const openFormBtn = document.getElementById('openFormBtn');
        const userPostsGrid = document.getElementById('userPostsGrid');
        const profileName = document.getElementById('profileName');
        const profileEmail = document.getElementById('profileEmail');
        const saldoBadge = document.getElementById('saldoBadge');
        const pubCount = document.getElementById('pubCount');
        const vendidosCount = document.getElementById('vendidosCount');
        const logoutBtn = document.getElementById('logoutBtn');
        const recargarBtn = document.getElementById('recargarBtn');
        const emprendedorStatusDiv = document.getElementById('emprendedorSection'); // Contenedor del estado
        const btnSolicitarEmprendedor = document.getElementById('btnSolicitarEmprendedor'); // Bot√≥n de solicitud
        const modalEmprendedor = document.getElementById('modalEmprendedor');
        const modalContent = document.getElementById('modalContent');
        const btnCerrarModal = document.getElementById('btnCerrarModal');
        const formSolicitudEmprendedor = document.getElementById('formSolicitudEmprendedor');


        let currentUserId = null;
        let currentUserRol = 'Usuario'; // Variable para almacenar el rol

        // ---------------------------------------------------
        // --- FUNCIONES ESPEC√çFICAS DE EMPRENDEDOR (NUEVAS) ---
        // ---------------------------------------------------

        function mostrarFormularioEmprendedor() {
            modalEmprendedor.classList.add('modal-visible');
            // Aplicar transici√≥n para animar la aparici√≥n del modal
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
            }, 10);
        }

        function cerrarFormularioEmprendedor() {
            modalContent.classList.add('scale-95', 'opacity-0');
            // Retrasar la ocultaci√≥n completa para que termine la transici√≥n
            setTimeout(() => {
                modalEmprendedor.classList.remove('modal-visible');
                formSolicitudEmprendedor.reset(); // Limpiar el formulario
            }, 300); 
        }

        async function verificarEstadoEmprendedor(userId) {
            // Verifica el rol del usuario
            if (currentUserRol === 'Emprendedor') {
                emprendedorStatusDiv.innerHTML = `
                    <h3 class="text-lg font-semibold text-green-700 mb-2 flex items-center">
                        <i class="fas fa-award mr-2"></i> Rol: Emprendedor Certificado
                    </h3>
                    <p class="text-gray-700">¬°Felicidades! Tienes permiso para crear ofertas de monetizaci√≥n.</p>
                `;
                return;
            }

            // Si no es Emprendedor, verifica si ya tiene una solicitud pendiente
            const { data, error } = await supabase
                .from('perfil_emprendedor')
                .select('estado_solicitud')
                .eq('usuario_id', userId)
                .order('fecha_solicitud', { ascending: false })
                .limit(1)
                .single();

            if (error && error.code !== 'PGRST116') { // PGRST116 es "No rows found"
                console.error('Error al verificar solicitud:', error.message);
            }

            if (data && data.estado_solicitud === 'pendiente') {
                btnSolicitarEmprendedor.disabled = true;
                btnSolicitarEmprendedor.classList.remove('bg-green-600', 'hover:bg-green-700');
                btnSolicitarEmprendedor.classList.add('bg-gray-400', 'cursor-not-allowed');
                btnSolicitarEmprendedor.innerHTML = '<i class="fas fa-clock mr-1"></i> Solicitud Pendiente';
                document.getElementById('emprendedorStatus').textContent = 'Tu solicitud de emprendedor est√° siendo revisada por el administrador.';
            } 
            // Si no hay data o est√° rechazada, el bot√≥n sigue activo (mostrarFormularioEmprendedor)
        }

        async function enviarSolicitudEmprendedor(event) {
            event.preventDefault();

            if (!currentUserId) {
                alert("Debes iniciar sesi√≥n para enviar una solicitud.");
                return;
            }

            const nombreNegocio = document.getElementById('nombreNegocio').value.trim();
            const descripcion = document.getElementById('descripcionNegocio').value.trim();
            const productos = document.getElementById('productosServicios').value.trim();
            const urlContacto = document.getElementById('urlContacto').value.trim();

            if (!nombreNegocio || !descripcion || !productos) {
                // Usar un mensaje personalizado en lugar de alert
                console.error("Por favor, completa todos los campos obligatorios.");
                return;
            }
            
            try {
                // 3. Insertar la solicitud en la tabla 'perfil_emprendedor'
                const { error } = await supabase
                    .from('perfil_emprendedor')
                    .insert({
                        usuario_id: currentUserId,
                        nombre_negocio: nombreNegocio,
                        descripcion_negocio: descripcion,
                        productos_servicios: productos,
                        url_contacto: urlContacto,
                        estado_solicitud: 'pendiente'
                    });

                if (error) throw error;

                // Reemplazar alert()
                console.log('‚úÖ Solicitud enviada con √©xito. Recibir√°s una notificaci√≥n cuando sea aprobada.');
                
                // 4. Cerrar el modal y actualizar la vista
                cerrarFormularioEmprendedor();
                
                // Forzar la actualizaci√≥n del mensaje de estado
                currentUserRol = 'Usuario'; 
                verificarEstadoEmprendedor(currentUserId);

            } catch (error) {
                console.error('Error al enviar solicitud de emprendedor:', error);
                // Reemplazar alert()
                console.error('‚ùå Error al enviar la solicitud: ' + error.message);
            }
        }


        // ---------------------------------------------------
        // --- FUNCIONES DE UTILIDAD (TU C√ìDIGO ORIGINAL) ---
        // ---------------------------------------------------

        // Cargar datos del usuario
        async function loadUserData() {
            try {
                const { data: { user } } = await supabase.auth.getUser();
                
                if (!user) {
                    // Reemplazar alert()
                    console.log('Debes iniciar sesi√≥n para ver tu perfil');
                    window.location.href = 'index.html';
                    return;
                }

                currentUserId = user.id;

                // Obtener datos del usuario desde la tabla 'usuario'
                const { data: usuario, error } = await supabase
                    .from('usuario')
                    .select('*')
                    .eq('auth_id', user.id)
                    .single();

                if (error) throw error;

                if (usuario) {
                    profileName.textContent = usuario.nombre_completo || 'Usuario';
                    profileEmail.textContent = usuario.correo_electronico || user.email;
                    
                    const saldo = usuario.saldo_creditos || 0;
                    saldoBadge.textContent = `${saldo} ‚ôªÔ∏è`;
                    localStorage.setItem('user_saldo', saldo);
                    
                    currentUserRol = usuario.rol || 'Usuario'; 
                    localStorage.setItem('user_rol', currentUserRol); 
                    
                    // Iniciar la verificaci√≥n del estado de emprendedor
                    verificarEstadoEmprendedor(currentUserId);
                } 

            } catch (error) {
                console.error('Error al cargar datos del usuario:', error);
                // Fallback (de tu c√≥digo original)
                const userName = localStorage.getItem('user_name') || 'Usuario';
                const userEmail = localStorage.getItem('user_email') || '';
                const userSaldo = localStorage.getItem('user_saldo') || '0';
                
                profileName.textContent = userName;
                profileEmail.textContent = userEmail;
                saldoBadge.textContent = `${userSaldo} ‚ôªÔ∏è`;
            }
        }

        // Cargar publicaciones del usuario
        async function fetchUserPosts() {
            if (!currentUserId) {
                console.log('No hay currentUserId, no se pueden cargar publicaciones');
                return;
            }

            userPostsGrid.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Cargando publicaciones...</div>';
            
            try {
                const { data: posts, error } = await supabase
                    .from('Publicacion')
                    .select('*')
                    .eq('usuario_id', currentUserId)
                    .order('id_publicacion', { ascending: false });

                if (error) throw error;
                
                renderPostsGrid(posts || []);
                updateStats(posts || []);

            } catch (err) {
                console.error('Error completo al cargar publicaciones:', err);
                userPostsGrid.innerHTML = `
                    <div class="no-posts">
                        <h3>‚ùå Error al cargar las publicaciones</h3>
                        <p>${err.message}</p>
                        <button onclick="window.location.href='publicar.html'" 
                                class="btn-publicar" style="margin-top: 15px;">
                            <i class="fas fa-plus"></i>
                            Intentar Crear Publicaci√≥n
                        </button>
                    </div>
                `;
            }
        }

        // Renderizar publicaciones
        function renderPostsGrid(posts) {
            userPostsGrid.innerHTML = '';
            
            if (posts.length === 0) {
                userPostsGrid.innerHTML = `
                    <div class="no-posts">
                        <h3>üì≠ A√∫n no tienes publicaciones</h3>
                        <p>Comienza tu journey en el trueque digital creando tu primera publicaci√≥n</p>
                        <button onclick="window.location.href='publicar.html'" 
                                class="btn-publicar" style="margin-top: 20px;">
                            <i class="fas fa-plus"></i>
                            Crear Mi Primera Publicaci√≥n
                        </button>
                    </div>
                `;
            } else {
                posts.forEach(p => {
                    const card = document.createElement('div');
                    card.className = 'pub-card';
                    card.dataset.id = p.id_publicacion;
                    
                    const titulo = p.titulo || p.description || 'Sin t√≠tulo';
                    const descripcion = p.descripcion || p.meaning_of_text || 'Sin descripci√≥n';
                    const precio = p.precio || p.private || 0;
                    const categoria = p.nombre_categoria || p.mention_anticipator || 'General';
                    const imagen = p.imagen_url || p.images_url || null;
                    
                    card.innerHTML = `
                        ${imagen ? `
                            <img src="${imagen}" alt="${titulo}" 
                                onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                        ` : `
                            <div style="width: 100%; height: 200px; background: linear-gradient(135deg, #f0f3f0 0%, #e6f4ea 100%); 
                                        display: flex; align-items: center; justify-content: center; color: #999;">
                                <i class="fas fa-image" style="font-size: 3rem;"></i>
                            </div>
                        `}
                        
                        <div class="pub-credit">${precio} ‚ôªÔ∏è</div>
                        
                        <div class="menu-dots" data-id="${p.id_publicacion}">
                            <i class="fas fa-ellipsis-v"></i>
                        </div>
                        
                        <ul class="menu-opciones" id="menu-${p.id_publicacion}">
                            <li data-action="edit" data-id="${p.id_publicacion}">
                                <i class="fas fa-edit"></i> Editar
                            </li>
                            <li data-action="delete" data-id="${p.id_publicacion}" style="color: #f44336;">
                                <i class="fas fa-trash"></i> Eliminar
                            </li>
                        </ul>

                        <div class="pub-content">
                            <strong>${titulo}</strong>
                            <p>${descripcion}</p>
                            <small>
                                <i class="fas fa-tag"></i> Categor√≠a: ${categoria}
                            </small>
                        </div>
                    `;
                    userPostsGrid.appendChild(card);
                });
            }
        }

        // Actualizar estad√≠sticas
        function updateStats(posts) {
            pubCount.textContent = posts.length;
            vendidosCount.textContent = '0';
        }

        // Eliminar publicaci√≥n
        async function handleDeletePost(postId) {
            if (!window.confirm('¬øEst√°s seguro de que quieres eliminar esta publicaci√≥n? Esta acci√≥n es irreversible.')) {
                return;
            }

            try {
                const { error } = await supabase
                    .from('Publicacion')
                    .delete()
                    .eq('id_publicacion', postId)
                    .eq('usuario_id', currentUserId);

                if (error) throw error;

                // Reemplazar alert()
                console.log('‚úÖ Publicaci√≥n eliminada con √©xito.');
                fetchUserPosts();

            } catch (err) {
                console.error('Error al eliminar publicaci√≥n:', err);
                // Reemplazar alert()
                console.error('‚ùå Error al eliminar la publicaci√≥n.');
            }
        }

        // Cerrar sesi√≥n
        async function handleLogout() {
            try {
                const { error } = await supabase.auth.signOut();
                if (error) throw error;

                localStorage.removeItem('user_id');
                localStorage.removeItem('user_email');
                localStorage.removeItem('user_name');
                localStorage.removeItem('user_saldo');
                localStorage.removeItem('user_rol');

                // Reemplazar alert()
                console.log('Sesi√≥n cerrada correctamente');
                window.location.href = 'index.html?logout=true';

            } catch (error) {
                console.error('Error al cerrar sesi√≥n:', error);
                // Reemplazar alert()
                console.error('Error al cerrar sesi√≥n');
            }
        }

        // --- Event Listeners ---
        // 1. Botones de Navegaci√≥n
        backBtn.addEventListener('click', () => {
            window.location.href = 'index2.html';
        });

        openFormBtn.addEventListener('click', () => {
            window.location.href = 'publicar.html';
        });

        logoutBtn.addEventListener('click', handleLogout);

        recargarBtn.addEventListener('click', () => {
            window.location.href = 'compra.html';
        });

        // 2. Eventos del Modal de Emprendedor (NUEVOS)
        btnSolicitarEmprendedor.addEventListener('click', mostrarFormularioEmprendedor);
        btnCerrarModal.addEventListener('click', cerrarFormularioEmprendedor);
        formSolicitudEmprendedor.addEventListener('submit', enviarSolicitudEmprendedor);

        // 3. L√≥gica de Men√∫s y Cierre General
        userPostsGrid.addEventListener('click', function(event) {
            const target = event.target;
            const menuDots = target.closest('.menu-dots');
            const menuItem = target.closest('li[data-action]');
            
            if (menuDots) {
                const postId = menuDots.dataset.id;
                const menu = document.getElementById(`menu-${postId}`);
                
                document.querySelectorAll('.menu-opciones.show').forEach(m => {
                    if (m.id !== `menu-${postId}`) m.classList.remove('show');
                });

                menu.classList.toggle('show');
            }

            if (menuItem) {
                const action = menuItem.dataset.action;
                const postId = menuItem.dataset.id;

                menuItem.closest('.menu-opciones').classList.remove('show');

                if (action === 'delete') {
                    handleDeletePost(postId);
                } else if (action === 'edit') {
                    window.location.href = `editar.html?id=${postId}`;
                }
            }
        });

        // Cerrar men√∫s y modal al hacer click fuera
        document.addEventListener('click', function(event) {
            // Cierre de men√∫s de publicaci√≥n
            if (!event.target.closest('.menu-dots') && !event.target.closest('.menu-opciones')) {
                document.querySelectorAll('.menu-opciones.show').forEach(menu => {
                    menu.classList.remove('show');
                });
            }
            
            // Cierre del modal de emprendedor
            if (modalEmprendedor.classList.contains('modal-visible') && !modalContent.contains(event.target) && !btnSolicitarEmprendedor.contains(event.target)) {
                cerrarFormularioEmprendedor();
            }
        });

        // Inicializar al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', async () => {
            // Ocultar el modal al inicio
            modalEmprendedor.classList.remove('modal-visible');

            await loadUserData(); 
            await fetchUserPosts();
        });
    </script>
</body>
</html>